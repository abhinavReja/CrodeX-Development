{% extends "base.html" %}

{% block title %}Results - CrodeX{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/result.css') }}">
{% endblock %}

{% block content %}
<section class="result-header">
    <div class="status-badge success">
        <i class="fas fa-check-circle"></i>
        Conversion Complete
    </div>
    <h1>Your package is ready</h1>
    <p class="subtitle">Download the converted project and the migration guide.</p>
</section>

<section class="result-actions-section">
    <div class="result-actions card">
        <div class="result-summary-container">
            <p id="result-summary" class="result-summary">
                Converted from <span id="source-framework">Source</span> â†’ <span id="target-framework">Target</span>. 
                Processed <span id="files-count">0</span> files.
            </p>
        </div>
        <div class="result-buttons">
            <a href="{{ url_for('api_download.download_file_content', file_id=file_id) }}" class="btn btn-primary" id="download-zip" download>
                <i class="fas fa-file-archive"></i>
                Download ZIP
            </a>
            <a href="#" class="btn btn-secondary" id="download-guide">
                <i class="fas fa-book"></i>
                Migration Guide
            </a>
            <a href="{{ url_for('upload.upload') }}" class="btn btn-link">
                Start New Conversion
            </a>
        </div>
    </div>
</section>

<section class="result-more-section">
    <div class="result-more">
        <h3>
            <i class="fas fa-info-circle"></i>
            What's inside?
        </h3>
        <ul class="result-list">
            <li>Converted project scaffold for your target framework</li>
            <li>Notes on files that need manual review</li>
            <li>Step-by-step migration checklist</li>
        </ul>
    </div>
</section>

<!-- File Details (Existing Feature - Keep it) -->
<section class="file-details-section">
    <div class="file-details-card">
        <h3>
            <i class="fas fa-file"></i>
            File Details
        </h3>
        <div class="file-details">
            <div class="detail-item">
                <span class="detail-label">Original File:</span>
                <span class="detail-value" id="original-name">{{ original_name }}</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">Processed File:</span>
                <span class="detail-value" id="processed-name">{{ processed_name }}</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">File Size:</span>
                <span class="detail-value" id="file-size">{% if file_size %}{{ file_size | filesizeformat }}{% else %}N/A{% endif %}</span>
            </div>
        </div>
    </div>
</section>

<!-- Share Options (Existing Feature - Keep it) -->
<section class="share-options-section">
    <div class="share-options-card">
        <h3>
            <i class="fas fa-share-alt"></i>
            Share Options
        </h3>
        <div class="share-buttons">
            <button type="button" class="btn btn-outline" id="copy-link-btn">
                <i class="fas fa-link"></i>
                Copy Link
            </button>
            <button type="button" class="btn btn-outline" id="email-btn">
                <i class="fas fa-envelope"></i>
                Email
            </button>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    const fileId = '{{ file_id }}';
    const downloadUrl = '{{ url_for("download.download_file", file_id=file_id) }}';
    const files_processed = {{ files_processed | default(0) }};
</script>
<script src="{{ url_for('static', filename='js/state.js') }}"></script>
<script src="{{ url_for('static', filename='js/download.js') }}"></script>
{% endblock %}
